<!doctypehtml><html class=no-js lang=en><meta charset=utf-8><meta content=on http-equiv=x-dns-prefetch-control><link href=//oi-wiki.org rel=dns-prefetch><link href=//search.oi-wiki.org rel=dns-prefetch><link href=//api.github.com rel=dns-prefetch><link href=//www.google-analytics.com rel=dns-prefetch><meta content=width=device-width,initial-scale=1 name=viewport><meta content="CoderBak's Blog"name=description><meta content=CoderBak name=author><link href=https://coderbak.com/math/simplex/ rel=canonical><link href=../linear-programming/ rel=prev><link href=../group-theory/ rel=next><link href=../../favicon.ico rel=icon><meta content="mkdocs-1.5.3, mkdocs-material-9.4.6"name=generator><title>单纯形算法 - CoderBak's Blog</title><link href=../../assets/stylesheets/main.f5281797.min.css rel=stylesheet><link href=../../assets/stylesheets/palette.356b1318.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href=https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CJetbrains+Mono:400,400i,700,700i&display=fallback rel=stylesheet><style>:root{--md-text-font:"Fira Sans";--md-code-font:"Jetbrains Mono"}@font-face {font-family:'Fira Sans';font-style:normal;font-weight:300;src:local('Fira Sans'),local('FiraSans-Normal'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-300.svg#FiraSans) format('svg')}@font-face {font-family:'Fira Sans';font-style:normal;font-weight:regular;src:local('Fira Sans'),local('FiraSans-Normal'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-regular.svg#FiraSans) format('svg')}@font-face {font-family:'Fira Sans';font-style:italic;font-weight:regular;src:local('Fira Sans'),local('FiraSans-Italic'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-italic.svg#FiraSans) format('svg')}@font-face {font-family:'Fira Sans';font-style:normal;font-weight:700;src:local('Fira Sans'),local('FiraSans-Normal'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-sans/fira-sans-700.svg#FiraSans) format('svg')}@font-face {font-family:'Fira Mono';font-style:normal;font-weight:regular;src:local('Fira Mono'),local('FiraMono-Normal'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.eot?#iefix) format('embedded-opentype'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff2) format('woff2'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.woff) format('woff'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.ttf) format('truetype'),url(//lib.baomitu.com/fonts/fira-mono/fira-mono-regular.svg#FiraMono) format('svg')}</style><link href=../../_static/css/extra.css?v=14 rel=stylesheet><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head><body data-md-color-accent=red data-md-color-primary=white data-md-color-scheme=default dir=ltr><script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#定义> Skip to content </a></div><div data-md-component=announce></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid"aria-label=Header><a aria-label="CoderBak's Blog"class="md-header__button md-logo"title="CoderBak's Blog"data-md-component=logo href=../..> <svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M13 19v-3h8v3h-8m-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5l6-6Z"/></svg> </a><label class="md-header__button md-icon"for=__drawer><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> CoderBak's Blog </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> 单纯形算法 </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode"data-md-color-media="(prefers-color-scheme: light)"class=md-option data-md-color-accent=red data-md-color-primary=white data-md-color-scheme=default id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon"title="Switch to dark mode"for=__palette_2 hidden><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg></label><input aria-label="Switch to light mode"data-md-color-media="(prefers-color-scheme: dark)"class=md-option data-md-color-accent=blue data-md-color-primary=blue data-md-color-scheme=slate id=__palette_2 name=__palette type=radio><label class="md-header__button md-icon"title="Switch to light mode"for=__palette_1 hidden><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg></label></form><label class="md-header__button md-icon"for=__search><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon"for=__search><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg></label><nav aria-label=Search class=md-search__options><button class="md-search__icon md-icon"aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg></button></nav></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div></nav></header><div class=md-container data-md-component=container><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../..> Home </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../courses/> Courses </a></li><li class=md-tabs__item><a class=md-tabs__link href=../../topics/base/> Topics </a></li><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../> 数学 </a></li></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary"data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted"aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a aria-label="CoderBak's Blog"class="md-nav__button md-logo"title="CoderBak's Blog"data-md-component=logo href=../..> <svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M13 19v-3h8v3h-8m-4.5-6L2.47 7h4.24l4.96 4.95c.58.59.58 1.55 0 2.12L6.74 19H2.5l6-6Z"/></svg> </a> CoderBak's Blog</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../..> <span class=md-ellipsis> Home </span> </a></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_2 type=checkbox> <label class=md-nav__link for=__nav_2 id=__nav_2_label><span class=md-ellipsis> Courses </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_2><span class="md-nav__icon md-icon"></span> Courses</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../courses/> <span class=md-ellipsis> Introduction </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_2_2 type=checkbox> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0><span class=md-ellipsis> Programming Basics </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_2><span class="md-nav__icon md-icon"></span> Programming Basics</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../courses/duke-c/> <span class=md-ellipsis> Duke Intro C </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../courses/berkeley-cs61a/> <span class=md-ellipsis> Berkeley CS61A </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../courses/stanford-cs106l/> <span class=md-ellipsis> Stanford CS106L </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../courses/aut-ap1400/> <span class=md-ellipsis> AUT AP1400 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_2_3 type=checkbox> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0><span class=md-ellipsis> Data Structs & Algos </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_2_3_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_2_3><span class="md-nav__icon md-icon"></span> Data Structs & Algos</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../courses/berkeley-cs61b/> <span class=md-ellipsis> Berkeley CS61B </span> </a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_3 type=checkbox> <label class=md-nav__link for=__nav_3 id=__nav_3_label><span class=md-ellipsis> Topics </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_3><span class="md-nav__icon md-icon"></span> Topics</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../topics/base/> <span class=md-ellipsis> test1 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_3_2 type=checkbox> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0><span class=md-ellipsis> 测试 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_3_2_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_3_2><span class="md-nav__icon md-icon"></span> 测试</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../topics/nlp/transformer.md> <span class=md-ellipsis> Transformer </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../../topics/nlp/base.md> <span class=md-ellipsis> test2 </span> </a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle"checked id=__nav_4 type=checkbox> <label class=md-nav__link for=__nav_4 id=__nav_4_label><span class=md-ellipsis> 数学 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_4_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_4><span class="md-nav__icon md-icon"></span> 数学</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../> <span class=md-ellipsis> 数学部分简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../notation/> <span class=md-ellipsis> 符号 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../base/> <span class=md-ellipsis> 进位制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../bit/> <span class=md-ellipsis> 位运算 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../binary-set/> <span class=md-ellipsis> 二进制集合操作 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../balanced-ternary/> <span class=md-ellipsis> 平衡三进制 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../bignum/> <span class=md-ellipsis> 高精度计算 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../binary-exponentiation/> <span class=md-ellipsis> 快速幂 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../permutation/> <span class=md-ellipsis> 置换和排列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../coordinate/> <span class=md-ellipsis> 弧度制与坐标系 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../complex/> <span class=md-ellipsis> 复数 </span> </a></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_4_12 type=checkbox> <label class=md-nav__link for=__nav_4_12 id=__nav_4_12_label tabindex=0><span class=md-ellipsis> 数论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_12_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_12><span class="md-nav__icon md-icon"></span> 数论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../number-theory/basic/> <span class=md-ellipsis> 数论基础 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/prime/> <span class=md-ellipsis> 素数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/gcd/> <span class=md-ellipsis> 最大公约数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/sqrt-decomposition/> <span class=md-ellipsis> 数论分块 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/euler-totient/> <span class=md-ellipsis> 欧拉函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/sieve/> <span class=md-ellipsis> 筛法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/meissel-lehmer/> <span class=md-ellipsis> Meissel–Lehmer 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/pollard-rho/> <span class=md-ellipsis> 分解质因数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/bezouts/> <span class=md-ellipsis> 裴蜀定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/euclidean/> <span class=md-ellipsis> 类欧几里德算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/fermat/> <span class=md-ellipsis> 欧拉定理 & 费马小定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/inverse/> <span class=md-ellipsis> 乘法逆元 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/linear-equation/> <span class=md-ellipsis> 线性同余方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/crt/> <span class=md-ellipsis> 中国剩余定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/lift-the-exponent/> <span class=md-ellipsis> 升幂引理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/wilson/> <span class=md-ellipsis> 威尔逊定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/lucas/> <span class=md-ellipsis> 卢卡斯定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/congruence-equation/> <span class=md-ellipsis> 同余方程 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/quad-residue/> <span class=md-ellipsis> 二次剩余 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/primitive-root/> <span class=md-ellipsis> 原根 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/discrete-logarithm/> <span class=md-ellipsis> 离散对数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/residue/> <span class=md-ellipsis> 剩余 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/mobius/> <span class=md-ellipsis> 莫比乌斯反演 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/du/> <span class=md-ellipsis> 杜教筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/powerful-number/> <span class=md-ellipsis> Powerful Number 筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/min-25/> <span class=md-ellipsis> Min_25 筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/zhou/> <span class=md-ellipsis> 洲阁筛 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/continued-fraction/> <span class=md-ellipsis> 连分数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/stern-brocot/> <span class=md-ellipsis> Stern–Brocot 树与 Farey 序列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/quadratic/> <span class=md-ellipsis> 二次域 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/periodic-continued-fraction/> <span class=md-ellipsis> 循环连分数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../number-theory/pell-equation/> <span class=md-ellipsis> Pell 方程 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_4_13 type=checkbox> <label class=md-nav__link for=__nav_4_13 id=__nav_4_13_label tabindex=0><span class=md-ellipsis> 多项式与生成函数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_13_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_13><span class="md-nav__icon md-icon"></span> 多项式与生成函数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../poly/intro/> <span class=md-ellipsis> 多项式与生成函数简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/fundamental/> <span class=md-ellipsis> 代数基本定理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/fft/> <span class=md-ellipsis> 快速傅里叶变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/ntt/> <span class=md-ellipsis> 快速数论变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/fwt/> <span class=md-ellipsis> 快速沃尔什变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/czt/> <span class=md-ellipsis> Chirp Z 变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/newton/> <span class=md-ellipsis> 多项式牛顿迭代 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/multipoint-eval-interpolation/> <span class=md-ellipsis> 多项式多点求值|快速插值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/elementary-func/> <span class=md-ellipsis> 多项式初等函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/linear-recurrence/> <span class=md-ellipsis> 常系数齐次线性递推 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/shift/> <span class=md-ellipsis> 多项式平移|连续点值平移 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/symbolic-method/> <span class=md-ellipsis> 符号化方法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/ogf/> <span class=md-ellipsis> 普通生成函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/egf/> <span class=md-ellipsis> 指数生成函数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../poly/dgf/> <span class=md-ellipsis> 狄利克雷生成函数 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_4_14 type=checkbox> <label class=md-nav__link for=__nav_4_14 id=__nav_4_14_label tabindex=0><span class=md-ellipsis> 组合数学 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_14_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_14><span class="md-nav__icon md-icon"></span> 组合数学</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../combinatorics/combination/> <span class=md-ellipsis> 排列组合 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/drawer-principle/> <span class=md-ellipsis> 抽屉原理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/inclusion-exclusion-principle/> <span class=md-ellipsis> 容斥原理 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/cantor/> <span class=md-ellipsis> 康托展开 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/fibonacci/> <span class=md-ellipsis> 斐波那契数列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/derangement/> <span class=md-ellipsis> 错位排列 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/catalan/> <span class=md-ellipsis> 卡特兰数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/stirling/> <span class=md-ellipsis> 斯特林数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/bell/> <span class=md-ellipsis> 贝尔数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/bernoulli/> <span class=md-ellipsis> 伯努利数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/entringer/> <span class=md-ellipsis> Entringer Number </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/eulerian/> <span class=md-ellipsis> Eulerian Number </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/partition/> <span class=md-ellipsis> 分拆数 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/vandermonde-convolution/> <span class=md-ellipsis> 范德蒙德卷积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../combinatorics/graph-enumeration/> <span class=md-ellipsis> 图论计数 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_4_15 type=checkbox> <label class=md-nav__link for=__nav_4_15 id=__nav_4_15_label tabindex=0><span class=md-ellipsis> 线性代数 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_15_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_15><span class="md-nav__icon md-icon"></span> 线性代数</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/> <span class=md-ellipsis> 线性代数简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/vector/> <span class=md-ellipsis> 向量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/product/> <span class=md-ellipsis> 内积和外积 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/matrix/> <span class=md-ellipsis> 矩阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/elementary-operations/> <span class=md-ellipsis> 初等变换 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/determinant/> <span class=md-ellipsis> 行列式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/vector-space/> <span class=md-ellipsis> 线性空间 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/basis/> <span class=md-ellipsis> 线性基 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/linear-mapping/> <span class=md-ellipsis> 线性映射 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/char-poly/> <span class=md-ellipsis> 特征多项式 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/diagonalization/> <span class=md-ellipsis> 对角化 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../linear-algebra/jordan/> <span class=md-ellipsis> Jordan标准型 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-nav__toggle md-toggle"checked id=__nav_4_16 type=checkbox> <label class=md-nav__link for=__nav_4_16 id=__nav_4_16_label tabindex=0><span class=md-ellipsis> 线性规划 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_4_16_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_16><span class="md-nav__icon md-icon"></span> 线性规划</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../linear-programming/> <span class=md-ellipsis> 线性规划简介 </span> </a></li><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle"id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active"for=__toc><span class=md-ellipsis> 单纯形算法 </span> <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active"href=./> <span class=md-ellipsis> 单纯形算法 </span> </a> <nav aria-label="Table of contents"class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#定义> 定义 </a></li><li class=md-nav__item><a class=md-nav__link href=#线性规划的一般形式> 线性规划的一般形式 </a></li><li class=md-nav__item><a class=md-nav__link href=#线性规划的可行域> 线性规划的可行域 </a></li><li class=md-nav__item><a class=md-nav__link href=#线性规划的标准形式> 线性规划的标准形式 </a></li><li class=md-nav__item><a class=md-nav__link href=#单纯形法> 单纯形法 </a> <nav aria-label=单纯形法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#几何意义> 几何意义 </a></li><li class=md-nav__item><a class=md-nav__link href=#如何判断最优> 如何判断最优 </a></li><li class=md-nav__item><a class=md-nav__link href=#如何选择新的基变量> 如何选择新的基变量 </a></li><li class=md-nav__item><a class=md-nav__link href=#如何选择被替换的基变量> 如何选择被替换的基变量 </a></li><li class=md-nav__item><a class=md-nav__link href=#终止条件> 终止条件 </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#理论罗列> 理论罗列 </a> <nav aria-label=理论罗列 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#标准型> 标准型 </a></li><li class=md-nav__item><a class=md-nav__link href=#转换为标准型> 转换为标准型 </a></li><li class=md-nav__item><a class=md-nav__link href=#松弛型> 松弛型 </a></li><li class=md-nav__item><a class=md-nav__link href=#变量> 变量 </a></li><li class=md-nav__item><a class=md-nav__link href=#可行解> 可行解 </a></li><li class=md-nav__item><a class=md-nav__link href=#转轴> 转轴 </a></li><li class=md-nav__item><a class=md-nav__link href=#初始化> 初始化 </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#算法实现> 算法实现 </a></li><li class=md-nav__item><a class=md-nav__link href=#对偶原理> 对偶原理 </a></li><li class=md-nav__item><a class=md-nav__link href=#全幺模矩阵totally-unimodular-matrix> 全幺模矩阵（Totally Unimodular Matrix） </a></li><li class=md-nav__item><a class=md-nav__link href=#习题练习> 习题练习 </a></li><li class=md-nav__item><a class=md-nav__link href=#参考资料> 参考资料 </a></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_4_17 type=checkbox> <label class=md-nav__link for=__nav_4_17 id=__nav_4_17_label tabindex=0><span class=md-ellipsis> 群论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_17_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_17><span class="md-nav__icon md-icon"></span> 群论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../group-theory/> <span class=md-ellipsis> 群论简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../permutation-group/> <span class=md-ellipsis> 置换群 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_4_18 type=checkbox> <label class=md-nav__link for=__nav_4_18 id=__nav_4_18_label tabindex=0><span class=md-ellipsis> 概率论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_18_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_18><span class="md-nav__icon md-icon"></span> 概率论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../probability/basic-conception/> <span class=md-ellipsis> 基本概念 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../probability/conditional-probability/> <span class=md-ellipsis> 条件概率与独立性 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../probability/random-variable/> <span class=md-ellipsis> 随机变量 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../probability/exp-var/> <span class=md-ellipsis> 随机变量的数字特征 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../probability/concentration-inequality/> <span class=md-ellipsis> 概率不等式 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_4_19 type=checkbox> <label class=md-nav__link for=__nav_4_19 id=__nav_4_19_label tabindex=0><span class=md-ellipsis> 博弈论 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_19_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_19><span class="md-nav__icon md-icon"></span> 博弈论</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../game-theory/intro/> <span class=md-ellipsis> 博弈论简介 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../game-theory/impartial-game/> <span class=md-ellipsis> 公平组合游戏 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../game-theory/partizan-game/> <span class=md-ellipsis> 非公平组合游戏 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../game-theory/misere-game/> <span class=md-ellipsis> 反常游戏 </span> </a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-nav__toggle md-toggle"id=__nav_4_20 type=checkbox> <label class=md-nav__link for=__nav_4_20 id=__nav_4_20_label tabindex=0><span class=md-ellipsis> 数值算法 </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=false aria-labelledby=__nav_4_20_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_4_20><span class="md-nav__icon md-icon"></span> 数值算法</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../numerical/lagrange/> <span class=md-ellipsis> 拉格朗日插值 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../numerical/integral/> <span class=md-ellipsis> 数值积分 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../numerical/gauss/> <span class=md-ellipsis> 高斯消元 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../numerical/newton/> <span class=md-ellipsis> 牛顿迭代法 </span> </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=../fourier-motzkin-elimination/> <span class=md-ellipsis> 傅里叶-莫茨金消元法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../order-theory/> <span class=md-ellipsis> 序理论 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../young-tableau/> <span class=md-ellipsis> 杨氏矩阵 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../schreier-sims/> <span class=md-ellipsis> Schreier–Sims 算法 </span> </a></li><li class=md-nav__item><a class=md-nav__link href=../berlekamp-massey/> <span class=md-ellipsis> Berlekamp–Massey 算法 </span> </a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary"data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents"class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#定义> 定义 </a></li><li class=md-nav__item><a class=md-nav__link href=#线性规划的一般形式> 线性规划的一般形式 </a></li><li class=md-nav__item><a class=md-nav__link href=#线性规划的可行域> 线性规划的可行域 </a></li><li class=md-nav__item><a class=md-nav__link href=#线性规划的标准形式> 线性规划的标准形式 </a></li><li class=md-nav__item><a class=md-nav__link href=#单纯形法> 单纯形法 </a> <nav aria-label=单纯形法 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#几何意义> 几何意义 </a></li><li class=md-nav__item><a class=md-nav__link href=#如何判断最优> 如何判断最优 </a></li><li class=md-nav__item><a class=md-nav__link href=#如何选择新的基变量> 如何选择新的基变量 </a></li><li class=md-nav__item><a class=md-nav__link href=#如何选择被替换的基变量> 如何选择被替换的基变量 </a></li><li class=md-nav__item><a class=md-nav__link href=#终止条件> 终止条件 </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#理论罗列> 理论罗列 </a> <nav aria-label=理论罗列 class=md-nav><ul class=md-nav__list><li class=md-nav__item><a class=md-nav__link href=#标准型> 标准型 </a></li><li class=md-nav__item><a class=md-nav__link href=#转换为标准型> 转换为标准型 </a></li><li class=md-nav__item><a class=md-nav__link href=#松弛型> 松弛型 </a></li><li class=md-nav__item><a class=md-nav__link href=#变量> 变量 </a></li><li class=md-nav__item><a class=md-nav__link href=#可行解> 可行解 </a></li><li class=md-nav__item><a class=md-nav__link href=#转轴> 转轴 </a></li><li class=md-nav__item><a class=md-nav__link href=#初始化> 初始化 </a></li></ul></nav></li><li class=md-nav__item><a class=md-nav__link href=#算法实现> 算法实现 </a></li><li class=md-nav__item><a class=md-nav__link href=#对偶原理> 对偶原理 </a></li><li class=md-nav__item><a class=md-nav__link href=#全幺模矩阵totally-unimodular-matrix> 全幺模矩阵（Totally Unimodular Matrix） </a></li><li class=md-nav__item><a class=md-nav__link href=#习题练习> 习题练习 </a></li><li class=md-nav__item><a class=md-nav__link href=#参考资料> 参考资料 </a></li></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1>单纯形算法</h1><h2 id=定义>定义<a title="Permanent link"class=headerlink href=#定义></a></h2><p>单纯形法是解决线性规划问题的一个有效的算法。</p><p>线性规划就是在一组线性约束条件下，求解目标函数最优解的问题。</p><h2 id=线性规划的一般形式>线性规划的一般形式<a title="Permanent link"class=headerlink href=#线性规划的一般形式></a></h2><p>在约束条件下，寻找目标函数 <span class=arithmatex>\(z\)</span> 的最大值：</p><div class=arithmatex>\[ \max \ z = x_1 + x_2 \]</div><div class=arithmatex>\[ s.t \begin{cases} 2x_1 + x_2 \leq 12 \\ x_1 + 2x_2 \leq 9 \\ x_1, x_2 \geq 0 \end{cases} \]</div><h2 id=线性规划的可行域>线性规划的可行域<a title="Permanent link"class=headerlink href=#线性规划的可行域></a></h2><p>满足线性规划问题约束条件的所有点组成的集合就是线性规划的可行域。若可行域有界（以下主要考虑有界可行域），线性规划问题的目标函数最优解必然在可行域的顶点上达到最优。</p><p>单纯形法就是通过设置不同的基向量，经过矩阵的线性变换，求得基可行解（可行域顶点），并判断该解是否最优，否则继续设置另一组基向量，重复执行以上步骤，直到找到最优解。所以，单纯形法的求解过程是一个循环迭代的过程。</p><p><img alt=kexingyu src=../images/kexingyu.jpg></p><p><center>图1 可行域</center></p><h2 id=线性规划的标准形式>线性规划的标准形式<a title="Permanent link"class=headerlink href=#线性规划的标准形式></a></h2><p>在说明单纯形法的原理之前，需要明白线性规划的标准形式。因为单纯形算法是通过线性规划的标准形来求解的。一般，规定线性规划的标准形式为：</p><div class=arithmatex>\[ \max \ z = \sum_{j = 1}^{n}c_jx_j \]</div><div class=arithmatex>\[ s.t \begin{cases} \displaystyle \sum_{j = 1}^{n}a_{ij}x_j = b_i, i = 1,2,\dots,m\\ x_j \geq 0 , j = 1,2,\dots,n \\ \end{cases} \]</div><p>写成矩阵形式：</p><div class=arithmatex>\[ \max \ z = CX \]</div><div class=arithmatex>\[ AX = b \]</div><div class=arithmatex>\[ X \geq 0 \]</div><div class=arithmatex>\[ A = \begin{bmatrix} a_{11} & a_{12} & \ldots & a_{1n}\\ a_{21} & a_{22} & \ldots & a_{2n}\\ \vdots & \vdots & \ddots & \vdots \\ a_{m1} & a_{m2} & \ldots & a_{mn} \end{bmatrix} \]</div><p>标准形的形式为：</p><ol><li><p>目标函数要求 <span class=arithmatex>\(\max\)</span></p></li><li><p>约束条件均为等式</p></li><li><p>决策变量为非负约束</p></li></ol><p>普通线性规划化为标准形：</p><ol><li><p>若目标函数为最小化，可以通过取负，求最大化</p></li><li><p>约束不等式为小于等于不等式，可以在左端加入非负变量，转变为等式，比如：</p> <div class=arithmatex>\[ x_1 + 2x_2 \leq 9 \implies \begin{cases} x_1 + 2x_2 + x_3 = 9 \\ x_3 \geq 0 \end{cases} \]</div> <p>同理，约束不等式为大于等于不等式时，可以在左端减去一个非负松弛变量，变为等式。</p></li><li><p>若存在取值无约束的变量，可转变为两个非负变量的差，比如：</p> <div class=arithmatex>\[ -\infty \leq x_k \leq +\infty \implies \begin{cases} x_k = x_m - x_n \\ x_m,x_n \geq 0 \end{cases} \]</div></li></ol><p>本文最开始的线性规划问题转化为标准形为：</p><div class=arithmatex>\[ \max \ z = x_1 + x_2 \]</div><div class=arithmatex>\[ s.t \begin{cases} 2x_1 + x_2 + x_3 = 12 \\ x_1 + 2x_2 + x_4 = 9 \\ x_1, x_2, x_3, x_4 \geq 0 \end{cases} \]</div><h2 id=单纯形法>单纯形法<a title="Permanent link"class=headerlink href=#单纯形法></a></h2><h3 id=几何意义>几何意义<a title="Permanent link"class=headerlink href=#几何意义></a></h3><p>在标准形中，有 <span class=arithmatex>\(m\)</span> 个约束条件（不包括非负约束），<span class=arithmatex>\(n\)</span> 个决策变量，且 <span class=arithmatex>\(n \geq m\)</span>。首先选取 <span class=arithmatex>\(m\)</span> 个基变量 <span class=arithmatex>\(x_j^{'}(j = 1, 2, \ldots, m )\)</span>，基变量对应约束系数矩阵的列向量线性无关。通过矩阵的线性变换，基变量可由非基变量表示：</p><div class=arithmatex>\[ x_i^{'} = C_i + \sum_{j = m + 1}^{n}m_{ij}x_j^{'}(i = 1, 2, \ldots , m) \]</div><p>如果令非基变量等于 <span class=arithmatex>\(0\)</span>，可求得基变量的值：</p><div class=arithmatex>\[ x_i^{'} = C_i \]</div><p>如果为可行解的话，<span class=arithmatex>\(C_i\)</span> 大于 <span class=arithmatex>\(0\)</span>。那么它的几何意义是什么呢？</p><p>还是通过上述具体的线性规划问题来说明：</p><div class=arithmatex>\[ \max \ z = x_1 + x_2 \]</div><div class=arithmatex>\[ s.t \begin{cases} 2x_1 + x_2 + x_3 = 12 \\ x_1 + 2x_2 + x_4 = 9 \\ x_1, x_2, x_3, x_4 \geq 0 \end{cases} \]</div><p>如果选择 <span class=arithmatex>\(x_2\)</span>、<span class=arithmatex>\(x_3\)</span> 为基变量，那么令 <span class=arithmatex>\(x_1\)</span>、<span class=arithmatex>\(x_4\)</span> 等于 <span class=arithmatex>\(0\)</span>，可以去求解基变量 <span class=arithmatex>\(x_2\)</span>、<span class=arithmatex>\(x_3\)</span> 的值。对系数矩阵做行变换，如下所示，<span class=arithmatex>\(x_2=\dfrac{9}{2}\)</span>，<span class=arithmatex>\(x_3=\dfrac{15}{2}\)</span>。</p><div class=arithmatex>\[ \begin{bmatrix} {\mathrm{X}} & {x_{1}} & {x_{2}} & {x_{3}} & {x_{4}} & {b} \\ {} & {2} & {1} & {1} & {0} & {12} \\ {} & {1} & {2} & {0} & {1} & {9} \\ {\mathrm{C}} & {1} & {1} & {0} & {0} & {z} \end{bmatrix}\to\begin{bmatrix} {\mathrm{X}} & {x_{1}} & {x_{2}} & {x_{3}} & {x_{4}} & {b} \\ {} & {\frac{3}{2}} & {0} & {1} & {-\frac{1}{2}} & {\frac{15}{2}} \\ {} & {\frac{1}{2}} & {1} & {0} & {\frac{1}{2}} & {\frac{9}{2}} \\ {\mathrm{C}} & {\frac{1}{2}} & {0} & {0} & {-\frac{1}{2}} & {z-\frac{9}{2}} \end{bmatrix} \]</div><p><span class=arithmatex>\(X_1=0\)</span> 表示可行解在 <span class=arithmatex>\(y\)</span> 轴上；<span class=arithmatex>\(X_4=0\)</span> 表示可行解在 <span class=arithmatex>\(x_1+2x_2=9\)</span> 的直线上。那么，求得的可行解即表示这两条直线的交点，也是可行域的顶点，如图所示：</p><p><img alt=kexingyu_point src=../images/kexingyu_point.jpg></p><p><center>图2</center></p><p>所以，通过选择不同的基变量，可以获得不同的可行域的顶点。</p><h3 id=如何判断最优>如何判断最优<a title="Permanent link"class=headerlink href=#如何判断最优></a></h3><p>如前所述，基变量可由非基变量表示：</p><div class=arithmatex>\[ x_i^{'} = C_i + \sum_{j = m + 1}^{n}m_{ij}x_j^{'}(i = 1, 2, \ldots , m) \]</div><p>目标函数 <span class=arithmatex>\(z\)</span> 也可以完全由非基变量表示：</p><div class=arithmatex>\[ z = z_0 + \sum_{j = m + 1}^{n} \sigma_j x_j^{'} \]</div><p>当达到最优解时，所有的 <span class=arithmatex>\(\sigma_j\)</span> 应小于等于 <span class=arithmatex>\(0\)</span>，当存在 <span class=arithmatex>\(j\)</span>，<span class=arithmatex>\(\sigma_j > 0\)</span> 时，当前解不是最优解，为什么？</p><p>当前的目标函数值为 <span class=arithmatex>\(z_0\)</span>，其中所有的非基变量值均取 <span class=arithmatex>\(0\)</span>。由之前分析可知，<span class=arithmatex>\(x_j^{'} = 0\)</span> 代表可行域的某个边界，是 <span class=arithmatex>\(x_j^{'}\)</span> 的最小值。如果可行解逐步离开这个边界，<span class=arithmatex>\(x_j^{'}\)</span> 会变大，因为 <span class=arithmatex>\(\sigma_j > 0\)</span>，显然目标函数的取值也会变大，所以当前解不是最优解。我们需要寻找新的基变量。</p><h3 id=如何选择新的基变量>如何选择新的基变量<a title="Permanent link"class=headerlink href=#如何选择新的基变量></a></h3><p>如果存在多个 <span class=arithmatex>\(\sigma_j > 0\)</span>，选择最大的 <span class=arithmatex>\(\sigma_j > 0\)</span> 对应的变量作为基变量，这表示目标函数随着 <span class=arithmatex>\(x_j^{'}\)</span> 的增加，增长的最快。</p><h3 id=如何选择被替换的基变量>如何选择被替换的基变量<a title="Permanent link"class=headerlink href=#如何选择被替换的基变量></a></h3><p>假如我们选择非基变量 <span class=arithmatex>\(x_s^{'}\)</span> 作为下一轮的基变量，那么被替换基变量 <span class=arithmatex>\(x_j^{'}\)</span> 在下一轮中作为非基变量，等于 <span class=arithmatex>\(0\)</span>。选择 <span class=arithmatex>\(x_j^{'}\)</span> 的原则：替换后应该尽量使 <span class=arithmatex>\(x_s^{'}\)</span> 值最大（因为上面已分析过，目标函数会随着 <span class=arithmatex>\(x_s^{'}\)</span> 的增大而增大），但要保证替换基变量后的解仍是可行解，因此应该选择最紧的限制。</p><p>继续通过上面的例子来说明：</p><div class=arithmatex>\[ \begin{bmatrix} {\mathrm{X}} & {x_{1}} & {x_{2}} & {x_{3}} & {x_{4}} & {b} \\ {} & {2} & {1} & {1} & {0} & {12} \\ {} & {1} & {2} & {0} & {1} & {9} \\ {\mathrm{C}} & {1} & {1} & {0} & {0} & {z} \end{bmatrix}\to\begin{bmatrix} {\mathrm{X}} & {x_{1}} & {x_{2}} & {x_{3}} & {x_{4}} & {b} \\ {} & {\frac{3}{2}} & {0} & {1} & {-\frac{1}{2}} & {\frac{15}{2}} \\ {} & {\frac{1}{2}} & {1} & {0} & {\frac{1}{2}} & {\frac{9}{2}} \\ {\mathrm{C}} & {\frac{1}{2}} & {0} & {0} & {-\frac{1}{2}} & {z-\frac{9}{2}} \end{bmatrix} \]</div><p>从最后一行可以看到，<span class=arithmatex>\(x_1\)</span> 的系数为 <span class=arithmatex>\(\dfrac{1}{2}>0\)</span>，所以选 <span class=arithmatex>\(x_2\)</span>、<span class=arithmatex>\(x_3\)</span> 为基变量并没有是目标函数达到最优。下一轮选取 <span class=arithmatex>\(x_1\)</span> 作为基变量，替换 <span class=arithmatex>\(x_2\)</span>、<span class=arithmatex>\(x_3\)</span> 中的某个变量。</p><p>第一行是符号</p><p>第二行：若 <span class=arithmatex>\(x_1\)</span> 替换 <span class=arithmatex>\(x_3\)</span> 作为基变量，<span class=arithmatex>\(x_3=0\)</span> 时，<span class=arithmatex>\(x_1=\dfrac{15/2}{3/2}=5\)</span></p><p>第三行：若 <span class=arithmatex>\(x_1\)</span> 替换 <span class=arithmatex>\(x_2\)</span> 作为基变量，<span class=arithmatex>\(x_2=0\)</span> 时，<span class=arithmatex>\(x_1=\dfrac{9/2}{1/2}=9\)</span></p><p>尽管替换 <span class=arithmatex>\(x_2\)</span> 后，<span class=arithmatex>\(x_1\)</span> 的值更大，但将它代入 <span class=arithmatex>\(x_3\)</span> 后会发现 <span class=arithmatex>\(x_3\)</span> 的值为负，不满足约束。从几何的角度来看，选择 <span class=arithmatex>\(x_2\)</span> 和 <span class=arithmatex>\(x_4\)</span> 作为非基变量，得到的解是直线 <span class=arithmatex>\(x_2=0\)</span> 和 <span class=arithmatex>\(x_1 + 2x_2 = 9\)</span> 的交点，它在可行域外。因此应该选择 <span class=arithmatex>\(x_3\)</span> 作为非基变量。</p><h3 id=终止条件>终止条件<a title="Permanent link"class=headerlink href=#终止条件></a></h3><p>当目标函数用非基变量的线性组合表示时，所有的系数均不大于 <span class=arithmatex>\(0\)</span>，则表示目标函数达到最优。</p><p>如果，有一个非基变量的系数为 <span class=arithmatex>\(0\)</span>，其他的均小于 <span class=arithmatex>\(0\)</span>，表示目标函数的最优解有无穷多个。这是因为目标函数的梯度与某一边界正交，在这个边界上，目标函数的取值均相等，且为最优。</p><p>使用单纯形法来求解线性规划，输入单纯形法的松弛形式，是一个大矩阵，第一行为目标函数的系数，且最后一个数字为当前轴值下的 <span class=arithmatex>\(z\)</span> 值。下面每一行代表一个约束，数字代表系数每行最后一个数字代表 <span class=arithmatex>\(b\)</span> 值。</p><p>算法和使用单纯性表求解线性规划相同。</p><p>对于线性规划问题：</p><div class=arithmatex>\[ \max \ x_1 + 14x_2 + 6x_3 \]</div><div class=arithmatex>\[ s.t \begin{cases} x_1 + x_2 + x_3 \leq 4 \\ x_1 \leq 2 \\ x_3 \leq 3 \\ 3x_2 + x_3 \leq 6 \\ x_1, x_2, x_3 \geq 0 \end{cases} \]</div><p>我们可以得到其松弛形式：</p><div class=arithmatex>\[ \max \ x_1 + 14x_2 + 6x_3 \]</div><div class=arithmatex>\[ s.t \begin{cases} x_1 + x_2 + x_3 + x_4 = 4 \\ x_1 + x_5 = 2 \\ x_3 + x_6 = 3 \\ 3x_2 + x_3 + x_7 = 6 \\ x_1, x_2, x_3, x_4, x_5, x_6, x_7 \geq 0 \end{cases} \]</div><p>我们可以构造单纯形表，其中最后一行打星的列为轴值。</p><table><thead><tr><th><span class=arithmatex>\(x_1\)</span></th><th><span class=arithmatex>\(x_2\)</span></th><th><span class=arithmatex>\(x_3\)</span></th><th><span class=arithmatex>\(x_4\)</span></th><th><span class=arithmatex>\(x_5\)</span></th><th><span class=arithmatex>\(x_6\)</span></th><th><span class=arithmatex>\(x_7\)</span></th><th><span class=arithmatex>\(b\)</span></th></tr></thead><tbody><tr><td><span class=arithmatex>\(c_1=1\)</span></td><td><span class=arithmatex>\(c_2=14\)</span></td><td><span class=arithmatex>\(c_3=6\)</span></td><td><span class=arithmatex>\(c_4=0\)</span></td><td><span class=arithmatex>\(c_5=0\)</span></td><td><span class=arithmatex>\(c_6=0\)</span></td><td><span class=arithmatex>\(c_7=0\)</span></td><td><span class=arithmatex>\(-z=0\)</span></td></tr><tr><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(4\)</span></td></tr><tr><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(2\)</span></td></tr><tr><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(3\)</span></td></tr><tr><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(3\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(6\)</span></td></tr><tr><td></td><td></td><td></td><td><span class=arithmatex>\(*\)</span></td><td><span class=arithmatex>\(*\)</span></td><td><span class=arithmatex>\(*\)</span></td><td><span class=arithmatex>\(*\)</span></td><td></td></tr></tbody></table><p>在单纯形表中，我们发现非轴值的 <span class=arithmatex>\(x\)</span> 上的系数大于零，因此可以通过增加这些个 <span class=arithmatex>\(x\)</span> 的值，来使目标函数增加。我们可以贪心的选择最大的 <span class=arithmatex>\(c\)</span>，在上面的例子中我们选择 <span class=arithmatex>\(c_2\)</span> 作为新的轴，加入轴集合中，那么谁该出轴呢？</p><p>其实我们由于每个 <span class=arithmatex>\(x\)</span> 都大于零，对于 <span class=arithmatex>\(x_2\)</span> 它的增加是有所限制的，如果 <span class=arithmatex>\(x_2\)</span> 过大，由于其他的限制条件，就会使得其他的 <span class=arithmatex>\(x\)</span> 小于零，于是我们应该让 <span class=arithmatex>\(x_2\)</span> 一直增大，直到有一个其他的 <span class=arithmatex>\(x\)</span> 刚好等于 <span class=arithmatex>\(0\)</span> 为止，那么这个 <span class=arithmatex>\(x\)</span> 就被换出轴。</p><p>我们可以发现，对于约束方程 <span class=arithmatex>\(1\)</span>，即第一行约束，<span class=arithmatex>\(x_2\)</span> 最大可以为 <span class=arithmatex>\(4\)</span>（<span class=arithmatex>\(\dfrac{4}{1}\)</span>），对于约束方程 <span class=arithmatex>\(4\)</span>，<span class=arithmatex>\(x_2\)</span> 最大可以为 <span class=arithmatex>\(2\)</span>（<span class=arithmatex>\(\dfrac{6}{3}\)</span>），因此 <span class=arithmatex>\(x_2\)</span> 最大只能为他们之间最小的那个，这样才能保证每个 <span class=arithmatex>\(x\)</span> 都大于零。因此使用第 <span class=arithmatex>\(4\)</span> 行，来对各行进行高斯行变换，使得第二列第四行中的每个 <span class=arithmatex>\(x\)</span> 都变成零，也包括 <span class=arithmatex>\(c_2\)</span>。这样我们就完成了把 <span class=arithmatex>\(x_2\)</span> 入轴，<span class=arithmatex>\(x_7\)</span> 出轴的过程。变换后的单纯形表为：</p><table><thead><tr><th><span class=arithmatex>\(x_1\)</span></th><th><span class=arithmatex>\(x_2\)</span></th><th><span class=arithmatex>\(x_3\)</span></th><th><span class=arithmatex>\(x_4\)</span></th><th><span class=arithmatex>\(x_5\)</span></th><th><span class=arithmatex>\(x_6\)</span></th><th><span class=arithmatex>\(x_7\)</span></th><th><span class=arithmatex>\(b\)</span></th></tr></thead><tbody><tr><td><span class=arithmatex>\(c_1=1\)</span></td><td><span class=arithmatex>\(c_2=0\)</span></td><td><span class=arithmatex>\(c_3=1.33\)</span></td><td><span class=arithmatex>\(c_4=0\)</span></td><td><span class=arithmatex>\(c_5=0\)</span></td><td><span class=arithmatex>\(c_6=0\)</span></td><td><span class=arithmatex>\(c_7=-4.67\)</span></td><td><span class=arithmatex>\(-z=-28\)</span></td></tr><tr><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0.67\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(-0.33\)</span></td><td><span class=arithmatex>\(2\)</span></td></tr><tr><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(2\)</span></td></tr><tr><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(3\)</span></td></tr><tr><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0.33\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0.33\)</span></td><td><span class=arithmatex>\(2\)</span></td></tr><tr><td></td><td><span class=arithmatex>\(*\)</span></td><td></td><td><span class=arithmatex>\(*\)</span></td><td><span class=arithmatex>\(*\)</span></td><td><span class=arithmatex>\(*\)</span></td><td></td><td></td></tr></tbody></table><p>继续计算，我们得到：</p><table><thead><tr><th><span class=arithmatex>\(x_1\)</span></th><th><span class=arithmatex>\(x_2\)</span></th><th><span class=arithmatex>\(x_3\)</span></th><th><span class=arithmatex>\(x_4\)</span></th><th><span class=arithmatex>\(x_5\)</span></th><th><span class=arithmatex>\(x_6\)</span></th><th><span class=arithmatex>\(x_7\)</span></th><th><span class=arithmatex>\(b\)</span></th></tr></thead><tbody><tr><td><span class=arithmatex>\(c_1=-1\)</span></td><td><span class=arithmatex>\(c_2=0\)</span></td><td><span class=arithmatex>\(c_3=0\)</span></td><td><span class=arithmatex>\(c_4=-2\)</span></td><td><span class=arithmatex>\(c_5=0\)</span></td><td><span class=arithmatex>\(c_6=0\)</span></td><td><span class=arithmatex>\(c_7=-4\)</span></td><td><span class=arithmatex>\(-z=-32\)</span></td></tr><tr><td><span class=arithmatex>\(1.5\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(1.5\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(-0.5\)</span></td><td><span class=arithmatex>\(3\)</span></td></tr><tr><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(2\)</span></td></tr><tr><td><span class=arithmatex>\(-1.5\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(-1.5\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0.5\)</span></td><td><span class=arithmatex>\(0\)</span></td></tr><tr><td><span class=arithmatex>\(-0.5\)</span></td><td><span class=arithmatex>\(1\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(-0.5\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0\)</span></td><td><span class=arithmatex>\(0.5\)</span></td><td><span class=arithmatex>\(1\)</span></td></tr><tr><td></td><td><span class=arithmatex>\(*\)</span></td><td><span class=arithmatex>\(*\)</span></td><td></td><td><span class=arithmatex>\(*\)</span></td><td><span class=arithmatex>\(*\)</span></td><td></td><td></td></tr></tbody></table><p>此时我们发现，所有非轴的 <span class=arithmatex>\(x\)</span> 的系数全部小于零，即增大任何非轴的 <span class=arithmatex>\(x\)</span> 值并不能使得目标函数最大，从而得到最优解 <span class=arithmatex>\(32\)</span>。</p><p>整个过程代码如下所示：</p><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&LTbits/stdc++.h></span>
<span class=k>using</span><span class=w> </span><span class=k>namespace</span><span class=w> </span><span class=nn>std</span><span class=p>;</span>
<span class=n>vector</span><span class=o><</span><span class=n>vector</span><span class=o><</span><span class=kt>double</span><span class=o>></span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>Matrix</span><span class=p>;</span>
<span class=kt>double</span><span class=w> </span><span class=n>Z</span><span class=p>;</span>
<span class=n>set</span><span class=o><</span><span class=kt>int</span><span class=o>></span><span class=w> </span><span class=n>P</span><span class=p>;</span>
<span class=kt>size_t</span><span class=w> </span><span class=n>cn</span><span class=p>,</span><span class=w> </span><span class=n>bn</span><span class=p>;</span>

<span class=kt>bool</span><span class=w> </span><span class=nf>Pivot</span><span class=p>(</span><span class=n>pair</span><span class=o><</span><span class=kt>size_t</span><span class=p>,</span><span class=w> </span><span class=kt>size_t</span><span class=o>></span><span class=w> </span><span class=o>&</span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  </span><span class=c1>// 返回0表示所有的非轴元素都小于0</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>  </span><span class=kt>double</span><span class=w> </span><span class=n>cmax</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>INT_MAX</span><span class=p>;</span>
<span class=w>  </span><span class=n>vector</span><span class=o><</span><span class=kt>double</span><span class=o>></span><span class=w> </span><span class=n>C</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
<span class=w>  </span><span class=n>vector</span><span class=o><</span><span class=kt>double</span><span class=o>></span><span class=w> </span><span class=n>B</span><span class=p>;</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>bn</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>B</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>Matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>cn</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>]);</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>C</span><span class=p>.</span><span class=n>size</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  </span><span class=c1>// 在非轴元素中找最大的c</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cmax</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>C</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>end</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>cmax</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>C</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
<span class=w>      </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cmax</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=kt>double</span><span class=w> </span><span class=n>bmin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>INT_MAX</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>bn</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>B</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>Matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>y</span><span class=p>];</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>Matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>y</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>bmin</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>bmin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tmp</span><span class=p>;</span>
<span class=w>      </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=n>p</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>make_pair</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>);</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>set</span><span class=o><</span><span class=kt>int</span><span class=o>>::</span><span class=n>iterator</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>begin</span><span class=p>();</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>end</span><span class=p>();</span><span class=w> </span><span class=n>it</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>Matrix</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=o>*</span><span class=n>it</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=c1>// cout<<"erase "<<*it<&LTendl;</span>
<span class=w>      </span><span class=n>P</span><span class=p>.</span><span class=n>erase</span><span class=p>(</span><span class=o>*</span><span class=n>it</span><span class=p>);</span>
<span class=w>      </span><span class=k>break</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>P</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>y</span><span class=p>);</span>
<span class=w>  </span><span class=c1>// cout<<"add "<&LTy<&LTendl;</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>void</span><span class=w> </span><span class=nf>pnt</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>Matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>Matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>cout</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=n>Matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=s>"</span><span class=se>\t</span><span class=s>"</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>cout</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=s>"result z:"</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=o>-</span><span class=n>Matrix</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>cn</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>void</span><span class=w> </span><span class=nf>Gaussian</span><span class=p>(</span><span class=n>pair</span><span class=o><</span><span class=kt>size_t</span><span class=p>,</span><span class=w> </span><span class=kt>size_t</span><span class=o>></span><span class=w> </span><span class=n>p</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  </span><span class=c1>// 行变换</span>
<span class=w>  </span><span class=kt>size_t</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>first</span><span class=p>;</span>
<span class=w>  </span><span class=kt>size_t</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>second</span><span class=p>;</span>
<span class=w>  </span><span class=kt>double</span><span class=w> </span><span class=n>norm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Matrix</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>y</span><span class=p>];</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>cn</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  </span><span class=c1>// 主行归一化</span>
<span class=w>    </span><span class=n>Matrix</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>/=</span><span class=w> </span><span class=n>norm</span><span class=p>;</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>bn</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>Matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>y</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=kt>double</span><span class=w> </span><span class=n>tmpnorm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>y</span><span class=p>];</span>
<span class=w>      </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>cn</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>Matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Matrix</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>tmpnorm</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>Matrix</span><span class=p>[</span><span class=n>x</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>

<span class=kt>void</span><span class=w> </span><span class=nf>solve</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>pair</span><span class=o><</span><span class=kt>size_t</span><span class=p>,</span><span class=w> </span><span class=kt>size_t</span><span class=o>></span><span class=w> </span><span class=n>t</span><span class=p>;</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>pnt</span><span class=p>();</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>Pivot</span><span class=p>(</span><span class=n>t</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>return</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>first</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=s>" "</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=n>t</span><span class=p>.</span><span class=n>second</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>set</span><span class=o><</span><span class=kt>int</span><span class=o>>::</span><span class=n>iterator</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>begin</span><span class=p>();</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>end</span><span class=p>();</span><span class=w> </span><span class=n>it</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>cout</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=o>*</span><span class=n>it</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=s>" "</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o><<</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
<span class=w>    </span><span class=n>Gaussian</span><span class=p>(</span><span class=n>t</span><span class=p>);</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>argc</span><span class=p>,</span><span class=w> </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>argv</span><span class=p>[])</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// ifstream fin;</span>
<span class=w>  </span><span class=c1>// fin.open("./test");</span>
<span class=w>  </span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>cn</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>bn</span><span class=p>;</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>bn</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>vector</span><span class=o><</span><span class=kt>double</span><span class=o>></span><span class=w> </span><span class=n>vectmp</span><span class=p>;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>cn</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=kt>double</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>      </span><span class=n>cin</span><span class=w> </span><span class=o>>></span><span class=w> </span><span class=n>tmp</span><span class=p>;</span>
<span class=w>      </span><span class=n>vectmp</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>tmp</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=n>Matrix</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>vectmp</span><span class=p>);</span>
<span class=w>  </span><span class=p>}</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=n>bn</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>P</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>cn</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>solve</span><span class=p>();</span>
<span class=p>}</span>

<span class=c1>/////////////////////////////////////</span>
<span class=c1>// glpk input:</span>
<span class=c1>///* Variables */</span>
<span class=c1>// var x1 >= 0;</span>
<span class=c1>// var x2 >= 0;</span>
<span class=c1>// var x3 >= 0;</span>
<span class=c1>///* Object function */</span>
<span class=c1>// maximize z: x1 + 14*x2 + 6*x3;</span>
<span class=c1>///* Constrains */</span>
<span class=c1>// s.t. con1: x1 + x2 + x3 <= 4;</span>
<span class=c1>// s.t. con2: x1  <= 2;</span>
<span class=c1>// s.t. con3: x3  <= 3;</span>
<span class=c1>// s.t. con4: 3*x2 + x3  <= 6;</span>
<span class=c1>// end;</span>
<span class=c1>/////////////////////////////////////</span>
<span class=c1>// myinput:</span>
<span class=cm>/*</span>
<span class=cm>8 5</span>
<span class=cm>1 14 6 0 0 0 0 0</span>
<span class=cm>1 1 1 1 0 0 0 4</span>
<span class=cm>1 0 0 0 1 0 0 2</span>
<span class=cm>0 0 1 0 0 1 0 3</span>
<span class=cm>0 3 1 0 0 0 1 6</span>
<span class=cm>*/</span>
<span class=c1>/////////////////////////////////////</span>
</code></pre></div></td></tr></table></div><h2 id=理论罗列>理论罗列<a title="Permanent link"class=headerlink href=#理论罗列></a></h2><h3 id=标准型>标准型<a title="Permanent link"class=headerlink href=#标准型></a></h3><p><span class=arithmatex>\(m+n\)</span> 个约束 <span class=arithmatex>\(n\)</span> 个变量用 <span class=arithmatex>\(x\)</span> 向量表示，<span class=arithmatex>\(A\)</span> 是一个 <span class=arithmatex>\(m\times n\)</span> 的矩阵，<span class=arithmatex>\(c\)</span> 是一个 <span class=arithmatex>\(n\)</span> 的向量，<span class=arithmatex>\(b\)</span> 是一个 <span class=arithmatex>\(m\)</span> 的向量，最大化 <span class=arithmatex>\(cx\)</span> 满足约束 <span class=arithmatex>\(Ax \leq b,x > 0\)</span>。</p><p>最大化 <span class=arithmatex>\(\sum_{j=1}^nc_jx_j\)</span> 满足如下约束条件：</p><div class=arithmatex>\[ \sum_{j = 1}^na_{ij}x_j \leq b_i,i = 1,2,\ldots,m \]</div><div class=arithmatex>\[ x_j \geq 0,j = 1,2,\ldots,n \]</div><p><span class=arithmatex>\(n\)</span> 个变量，<span class=arithmatex>\(m+n\)</span> 个约束，构造 <span class=arithmatex>\(m \times n\)</span> 的矩阵 <span class=arithmatex>\(A\)</span>，<span class=arithmatex>\(m\)</span> 维向量 <span class=arithmatex>\(b\)</span>，<span class=arithmatex>\(n\)</span> 维向量 <span class=arithmatex>\(c\)</span></p><p>最大化 <span class=arithmatex>\(C^Tx\)</span> 满足如下约束条件：</p><div class=arithmatex>\[ Ax \leq b \]</div><div class=arithmatex>\[ x \geq 0 \]</div><h3 id=转换为标准型>转换为标准型<a title="Permanent link"class=headerlink href=#转换为标准型></a></h3><p>若目标函数要求取最小值，那么可以对其取相反数变成取最大值。对于限制条件 <span class=arithmatex>\(f(x_1, x_2, \ldots ,x_n) = b\)</span>，可以用两个不等式 <span class=arithmatex>\(f(x_1, x_2, \ldots, x_n) \leq b,-f(x_1,x_2,\ldots,x_n) \leq -b\)</span> 描述，对于限制条件 <span class=arithmatex>\(f(x_1,x_2,\ldots,x_n) \geq b\)</span>，可以用不等式 <span class=arithmatex>\(-f(x_1,x_2,\ldots,x_n) \leq -b\)</span> 描述。对于无限制的变量 <span class=arithmatex>\(x\)</span>，可以将其拆为两个非负变量 <span class=arithmatex>\(x_0,x_1\)</span>，使得 <span class=arithmatex>\(x = x_0 - x_1\)</span>。</p><h3 id=松弛型>松弛型<a title="Permanent link"class=headerlink href=#松弛型></a></h3><p>基本变量 <span class=arithmatex>\(B\)</span>，<span class=arithmatex>\(|B|=m\)</span>，一个约束对应一个，表示松弛量，叫做松弛变量（基本变量）</p><p>非基变量 <span class=arithmatex>\(N\)</span>，<span class=arithmatex>\(|N|=n\)</span>，<span class=arithmatex>\(x_n + i = b_i - \sum a_{ij}x_j \geq 0\)</span></p><p>松弛变量 <span class=arithmatex>\(x_{n+i}\)</span></p><div class=arithmatex>\[ \sum_{j = 1}^na_{ij}x_j \leq b_i \rightarrow x_{n + i} = b_i - \sum_{j = 1}^{n}a_{ij}x_j, x_{n+i} \geq 0 \]</div><p>等式左侧为基本变量，右侧为非基本变量。</p><h3 id=变量>变量<a title="Permanent link"class=headerlink href=#变量></a></h3><ul><li>替入变量 <span class=arithmatex>\(x_e\)</span>（非基变量）</li><li>替出变量 <span class=arithmatex>\(x_l\)</span>（基本变量）</li></ul><h3 id=可行解>可行解<a title="Permanent link"class=headerlink href=#可行解></a></h3><ul><li><p>基本解：所有非基变量设为 <span class=arithmatex>\(0\)</span>，基本变量为右侧的常数</p></li><li><p>基本可行解：所有 <span class=arithmatex>\(b_i \geq 0\)</span></p></li></ul><blockquote><p>注：单纯形法的过程中 <span class=arithmatex>\(B\)</span> 和 <span class=arithmatex>\(N\)</span> 不断交换，在 <span class=arithmatex>\(n\)</span> 维空间中不断走，「相当于不等式上的高斯消元」。</p></blockquote><h3 id=转轴>转轴<a title="Permanent link"class=headerlink href=#转轴></a></h3><p>选取一个非基本变量 <span class=arithmatex>\(x_e\)</span> 为替入变量，基本变量 <span class=arithmatex>\(x_l\)</span> 为替出变量，将其互换，为了防止循环，根据 <strong>Bland 规则</strong>，选择下标最小的变量。</p><blockquote><p><strong>Bland 规则</strong> 可以参看：<a href=https://github.com/AngelKitty/review_the_national_post-graduate_entrance_examination/blob/master/books_and_notes/professional_courses/data_structures_and_algorithms/sources/extra_books/%E6%9C%80%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95.pdf>最优化方法</a></p></blockquote><h3 id=初始化>初始化<a title="Permanent link"class=headerlink href=#初始化></a></h3><p>在所有 <span class=arithmatex>\(b_i < 0\)</span> 的约束中随机选一个作为 <span class=arithmatex>\(x_l\)</span>，再随机选一个 <span class=arithmatex>\(a_{le} < 0\)</span> 作为 <span class=arithmatex>\(x_e\)</span>，然后 <span class=arithmatex>\(pivot(l,e)\)</span> 后 <span class=arithmatex>\(b_i\)</span> 就变正了。</p><h2 id=算法实现>算法实现<a title="Permanent link"class=headerlink href=#算法实现></a></h2><p>每个约束定义了 <span class=arithmatex>\(n\)</span> 维空间中的一个半空间（超平面），交集形成的可行域是一个凸区域称为单纯形。目标函数是一个超平面，最优解在凸区域定点处取得。通过不断的转轴操作，在 <span class=arithmatex>\(n\)</span> 维凸区域的顶点上不断移动（转轴），使得基本解的目标值不断变大，最终达到最优解。</p><blockquote><p>以下问题可以转换为单纯形：</p><ul><li>最短路</li><li>最大流</li><li>最小费用最大流</li><li>多商品流</li></ul></blockquote><p>基本思想就是改写 <span class=arithmatex>\(l\)</span> 这个约束为 <span class=arithmatex>\(x_e\)</span> 作为基本变量，然后把这个新 <span class=arithmatex>\(x_e\)</span> 的值带到其他约束和目标函数中，就消去 <span class=arithmatex>\(x_e\)</span> 了。改写和带入时要修改 <span class=arithmatex>\(b\)</span> 和 <span class=arithmatex>\(a\)</span>，目标函数则是 <span class=arithmatex>\(c\)</span> 和 <span class=arithmatex>\(v\)</span>。</p><p>转动时，<span class=arithmatex>\(l\)</span> 和 <span class=arithmatex>\(e\)</span> 并没有像算法导论上一样，<span class=arithmatex>\(a\)</span> 矩阵用了两行分别是 <span class=arithmatex>\(a_{l, \square}\)</span> 和 <span class=arithmatex>\(a_{e, \square}\)</span>（这样占用内存大），而是用了同一行，这样 <span class=arithmatex>\(a\)</span> 矩阵的行数 <span class=arithmatex>\(=|B|\)</span>，列数 <span class=arithmatex>\(=|N|\)</span>。</p><p>也就是说，约束条件只用 <span class=arithmatex>\(m\)</span> 个，尽管 <span class=arithmatex>\(B\)</span> 和 <span class=arithmatex>\(N\)</span> 不断交换，但同一时间还是只有 <span class=arithmatex>\(m\)</span> 个约束（基本变量），<span class=arithmatex>\(n\)</span> 个非基变量，注意改写成松弛型后 <span class=arithmatex>\(a\)</span> 矩阵实际系数为负。（一个优化为 <span class=arithmatex>\(a_{i,e}\)</span> 的约束没必要带入了）。</p><p><code>simplex</code> 是主过程，基本思想是找到一个 <span class=arithmatex>\(c_e>0\)</span> 的，然后找对这个 <span class=arithmatex>\(e\)</span> 限制最紧的 <span class=arithmatex>\(l\)</span>，转动这组 <span class=arithmatex>\(l,e\)</span>，注意精度控制 <span class=arithmatex>\(\epsilon\)</span>，<span class=arithmatex>\(c_e>\epsilon\)</span>，还有找 <span class=arithmatex>\(l\)</span> 的时候 <span class=arithmatex>\(a_{i,e}>\epsilon\)</span> 才行。</p><details class=note><summary>例题 <a href=https://www.luogu.com.cn/problem/P3980>「NOI2008」志愿者招募</a></summary> <p>题目大意：长度为 <span class=arithmatex>\(n\)</span> 的序列，第 <span class=arithmatex>\(i\)</span> 位至少 <span class=arithmatex>\(b_i\)</span>，<span class=arithmatex>\(m\)</span> 种区间使 <span class=arithmatex>\([l_i,r_i] + 1\)</span> 代价为 <span class=arithmatex>\(a_i\)</span>。</p></details><p>原始问题 <span class=arithmatex>\(m\)</span> 个变量，<span class=arithmatex>\(n\)</span> 个约束，当 <span class=arithmatex>\(l_j \leq i \leq r_j\)</span>，<span class=arithmatex>\(a_{ij} = 1\)</span>。</p><p>对偶问题 <span class=arithmatex>\(n\)</span> 个变量，<span class=arithmatex>\(m\)</span> 个约束</p><div class=arithmatex>\[ \max \ \sum_{i=1}^n b_iy_i \]</div><div class=arithmatex>\[ s.t \ \sum_{l_i \leq j \leq r_i}y_j \leq c_i, y_i \geq 0 \]</div><p>把对应出的系数矩阵代入到单纯形算法就可以求出最优解了。</p><div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span></pre></div></td><td class=code><div><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&LTalgorithm></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&LTcmath></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&LTcstdio></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&LTcstring></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&LTiostream></span>
<span class=k>using</span><span class=w> </span><span class=k>namespace</span><span class=w> </span><span class=nn>std</span><span class=p>;</span>
<span class=k>const</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>M</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>10005</span><span class=p>,</span><span class=w> </span><span class=n>N</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1005</span><span class=p>,</span><span class=w> </span><span class=n>INF</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1e9</span><span class=p>;</span>

<span class=kt>int</span><span class=w> </span><span class=nf>read</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>  </span><span class=c1>// 快读</span>
<span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getchar</span><span class=p>();</span>
<span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o><</span><span class=w> </span><span class=sc>'0'</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=sc>'9'</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=sc>'-'</span><span class=p>)</span><span class=w> </span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>-1</span><span class=p>;</span>
<span class=w>    </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getchar</span><span class=p>();</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=w> </span><span class=o>>=</span><span class=w> </span><span class=sc>'0'</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=sc>'9'</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>10</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=sc>'0'</span><span class=p>;</span>
<span class=w>    </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getchar</span><span class=p>();</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>f</span><span class=p>;</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
<span class=kt>double</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>M</span><span class=p>][</span><span class=n>N</span><span class=p>],</span><span class=w> </span><span class=n>b</span><span class=p>[</span><span class=n>M</span><span class=p>],</span><span class=w> </span><span class=n>c</span><span class=p>[</span><span class=n>N</span><span class=p>],</span><span class=w> </span><span class=n>v</span><span class=p>;</span>

<span class=kt>void</span><span class=w> </span><span class=nf>pivot</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>l</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  </span><span class=c1>// 转轴操作函数</span>
<span class=w>  </span><span class=n>b</span><span class=p>[</span><span class=n>l</span><span class=p>]</span><span class=w> </span><span class=o>/=</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>e</span><span class=p>];</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>/=</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>e</span><span class=p>];</span>
<span class=w>  </span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>e</span><span class=p>];</span>

<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=n>m</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>l</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>fabs</span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>e</span><span class=p>])</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>b</span><span class=p>[</span><span class=n>l</span><span class=p>];</span>
<span class=w>      </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
<span class=w>      </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>e</span><span class=p>];</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>  </span><span class=n>v</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>c</span><span class=p>[</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>b</span><span class=p>[</span><span class=n>l</span><span class=p>];</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>j</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=n>c</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=n>c</span><span class=p>[</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
<span class=w>  </span><span class=n>c</span><span class=p>[</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>c</span><span class=p>[</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>l</span><span class=p>][</span><span class=n>e</span><span class=p>];</span>

<span class=w>  </span><span class=c1>// swap(B[l],N[e])</span>
<span class=p>}</span>

<span class=kt>double</span><span class=w> </span><span class=nf>simplex</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=nb>true</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>e</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>e</span><span class=o>++</span><span class=p>)</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>break</span><span class=p>;</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>e</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>v</span><span class=p>;</span><span class=w>  </span><span class=c1>// 此时v即为最优解</span>
<span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>mn</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>INF</span><span class=p>;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=n>m</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>e</span><span class=p>]</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=mi>0</span><span class=w> </span><span class=o>&&</span><span class=w> </span><span class=n>mn</span><span class=w> </span><span class=o>></span><span class=w> </span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>e</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>mn</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>e</span><span class=p>];</span><span class=w>  </span><span class=c1>// 找对这个e限制最紧的l</span>
<span class=w>        </span><span class=n>l</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
<span class=w>      </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>mn</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>INF</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>INF</span><span class=p>;</span><span class=w>  </span><span class=c1>// unbounded</span>
<span class=w>    </span><span class=n>pivot</span><span class=p>(</span><span class=n>l</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>                </span><span class=c1>// 转动l,e</span>
<span class=w>  </span><span class=p>}</span>
<span class=p>}</span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>read</span><span class=p>();</span>
<span class=w>  </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>read</span><span class=p>();</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>read</span><span class=p>();</span>
<span class=w>  </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=n>m</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>read</span><span class=p>(),</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>read</span><span class=p>();</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>s</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o><=</span><span class=w> </span><span class=n>t</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>  </span><span class=c1>// 表示第i种志愿者在j时间可以服务</span>
<span class=w>    </span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>read</span><span class=p>();</span>
<span class=w>  </span><span class=p>}</span>
<span class=w>  </span><span class=n>printf</span><span class=p>(</span><span class=s>"%d"</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=p>)(</span><span class=n>simplex</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>0.5</span><span class=p>));</span>
<span class=p>}</span>
</code></pre></div></td></tr></table></div><h2 id=对偶原理>对偶原理<a title="Permanent link"class=headerlink href=#对偶原理></a></h2><p>最大化与最小化互换，常数与目标函数互换，改变不等号，变量与约束对应。</p><div class=arithmatex>\[ \max \ c^Tx: Ax \leq b, x \geq 0 \]</div><div class=arithmatex>\[ \min \ b^Ty: A^Ty \geq c, y \geq 0 \]</div><p><span class=arithmatex>\(d_{uv}\)</span> 表示 <span class=arithmatex>\(u,v\)</span> 是否匹配</p><div class=arithmatex>\[ \max \ \sum_{(u,v) \in E}c_{uv}d_{uv} \]</div><div class=arithmatex>\[ s.t \begin{cases} \sum_{(v) \in Y} d_{uv} \leq 1, u \in X \\ \sum_{(u) \in X} d_{uv} \leq 1, v \in Y \\ d_{u,v} \in \{0,1\} \end{cases} \]</div><p>令 <span class=arithmatex>\(p_u,p_v\)</span> 为两类约束对偶之后的变量</p><div class=arithmatex>\[ \min \ \sum_{u \in x} p_u + \sum_{v \in Y} p_v \]</div><div class=arithmatex>\[ s.t \begin{cases} p_u + p_v \geq c_{uv} \\ u \in X, v \in Y\\ p_u, p_v \geq 0 \end{cases} \]</div><h2 id=全幺模矩阵totally-unimodular-matrix>全幺模矩阵（Totally Unimodular Matrix）<a title="Permanent link"class=headerlink href=#全幺模矩阵totally-unimodular-matrix></a></h2><p><strong>充分条件：</strong></p><ul><li><p>仅有 <span class=arithmatex>\(-1,0,1\)</span> 构成</p></li><li><p>每列至多两个非零数</p></li><li><p>行可分为两个集合：</p> <ul><li>一列包含两个同号非零数，两行不在同一个集合</li><li>一列包含两个异号非零数，两行在同一个集合</li></ul></li></ul><p>线性规划中 <span class=arithmatex>\(A\)</span> 为全幺模矩阵，则单纯形法过程中所有系数 <span class=arithmatex>\(\in -1,0,1\)</span>，可以去除系数为 <span class=arithmatex>\(0\)</span> 的项进行优化！</p><blockquote><p>注：<strong>任何最大流、最小费用最大流的线性规划都是全幺模矩阵</strong></p></blockquote><p>更多详细的解释参看：<a href=https://www.cnblogs.com/ECJTUACM-873284962/p/7097864.html>https://www.cnblogs.com/ECJTUACM-873284962/p/7097864.html</a></p><h2 id=习题练习>习题练习<a title="Permanent link"class=headerlink href=#习题练习></a></h2><ul><li><a href=https://uoj.ac/problem/179>UOJ#179. 线性规划</a></li></ul><h2 id=参考资料>参考资料<a title="Permanent link"class=headerlink href=#参考资料></a></h2><ul><li><a href=https://www.cnblogs.com/ECJTUACM-873284962/p/7097864.html>线性规划之单纯形法【超详解 + 图解】</a></li><li><a href=https://github.com/OI-wiki/libs/blob/master/%E9%9B%86%E8%AE%AD%E9%98%9F%E5%8E%86%E5%B9%B4%E8%AE%BA%E6%96%87/%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F2016%E8%AE%BA%E6%96%87%E9%9B%86.pdf>2016 国家集训队论文</a></li><li>算法导论</li></ul><hr><blockquote class=page-copyright><span><i class=md-icon><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="m22.7 19-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4Z"/></svg></i>本页面最近更新：</span><span class=facts_modified></span>，<a class=edit_history>更新历史</a><br><span><i class=md-icon><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg></i>发现错误？想一起完善？ <a class=page_edit_url href=None title=edit.link.title>在 GitHub 上编辑此页！</a></span><br><span><i class=md-icon><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M16 17v2H2v-2s0-4 7-4 7 4 7 4m-3.5-9.5A3.5 3.5 0 1 0 9 11a3.5 3.5 0 0 0 3.5-3.5m3.44 5.5A5.32 5.32 0 0 1 18 17v2h4v-2s0-3.63-6.06-4M15 4a3.39 3.39 0 0 0-1.93.59 5 5 0 0 1 0 5.82A3.39 3.39 0 0 0 15 11a3.5 3.5 0 0 0 0-7Z"/></svg></i>本页面贡献者：</span><span class=page_contributors>OI-wiki</span><br><span><i class=md-icon><svg viewbox="0 0 24 24"xmlns=http://www.w3.org/2000/svg><path d="M10.08 10.86c.05-.33.16-.62.3-.86.3-.56.81-.85 1.5-.86.45 0 .86.2 1.15.49.28.31.47.74.47 1.17h1.8c-.02-.47-.11-.9-.3-1.3-.15-.38-.38-.72-.68-1-1.45-1.34-4.14-1.15-5.37.37-1.29 1.67-1.32 4.59-.01 6.26 1.21 1.49 3.86 1.7 5.3.37.31-.25.56-.56.76-.92.16-.36.27-.74.28-1.15H13.5c0 .21-.07.4-.16.57-.09.19-.21.34-.34.47-.33.26-.72.4-1.14.4-.36-.01-.66-.08-.89-.23a1.41 1.41 0 0 1-.59-.64c-.5-.9-.42-2.15-.3-3.14M12 2C6.5 2 2 6.5 2 12c.53 13.27 19.5 13.26 20 0 0-5.5-4.5-10-10-10m0 18c-4.41 0-8-3.59-8-8 .44-10.61 15.56-10.61 16 0 0 4.41-3.59 8-8 8Z"/></svg></i>本页面的全部内容在 <strong></strong> 协议之条款下提供，附加条款亦可能应用</span></blockquote></article></div></div></main><script>function scrollFunction(){20<document.body.scrollTop||20<document.documentElement.scrollTop?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}window.onscroll=function(){scrollFunction()}</script><button class=data-tip-left data-tip=回到顶部 id=myBtn onclick=topFunction()><svg class="Zi Zi--BackToTop data-tip-left"viewbox="0 0 24 24"data-tip=回到顶部 fill=currentColor height=24 width=24><path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path></svg></button><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright>Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs <div id=miitbeian></div> </a></div><div class=build_date_utc style=float:right><a href=https://github.com/OI-wiki/OI-wiki> 最近更新：, 2024-02-16 </a></div><script>"oi-wiki.com"==window.location.hostname&&(document.getElementById("miitbeian").innerHTML='<a href="http://beian.miit.gov.cn/">黑ICP备19005132号-2</a>'),console.log("%c OI Wiki %c  %c","background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent"),console.log("少年，恭喜你囍提彩蛋，我们在做一些 OI 相关的有趣的事情，如果您对此感兴趣，欢迎访问 https://join-us.oi-wiki.org")</script></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../..", "features": ["content.action.edit", "navigation.tabs", "navigation.instant"], "search": "../../assets/javascripts/workers/search.b6c651e9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script><script src=../../assets/javascripts/bundle.69a41b14.min.js></script><script src=../../_static/js/math-csr.js?math-csr></script><script src=../../assets/vendor/mathjax/es5/tex-mml-chtml.js?math-csr></script><script>"use strict";"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(function(e){console.log("PWA Registration succeeded. Scope is "+e.scope)}).catch(function(e){console.log("PWA Registration failed with "+e)})</script></body></html>